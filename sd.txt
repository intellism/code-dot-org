@startuml
title Middle School Teacher Registers For CSD Workshop

' Configuration
autonumber
hide footbox

' Participants
box "UI Flow" #LightGreen
actor teacher
participant browser as "browser"
end box

participant pea as "pegasus app"
participant dashboard as "dashboard app"
actor principal#white
actor partner as "regional partner"#white

' Flow
== Discover local workshops ==

teacher -> browser: Go to code.org
activate teacher
activate browser
browser -> pea: get /
activate pea
browser <-- pea: /sites.v3/code.org/public/index.haml
teacher <-- browser: Code.org homepage

teacher -> browser: Select //Middle School//
browser -> pea: get /educate/curriculum/middle-school
pea --> browser: /sites.v3/code.org/public/educate/curriculum/middle-school.md
teacher <-- browser: Middle school curriculum page

teacher -> browser: Select //Learn about professional learning//
browser -> pea: get /educate/professional-learning/middle-high
browser <-- pea: /sites.v3/code.org/public/educate/professional-learning/middle-high.md
teacher <-- browser: PD for Middle-High school page

teacher -> browser: Select //Apply Now// or //Get Started//
browser -> pea: get /educate/professional-learning/program-information
browser <-- pea: /sites.v3/code.org/public/educate/professional-learning/program-information.md
teacher <-- browser: Find Regional Information page

teacher -> browser: Enter a zip code
browser -> pea: ?
browser <-- pea: ?
deactivate pea
teacher <-- browser: List of regional partners and workshops

== Apply to Regional Partner's PD program ==

teacher -> browser: Select //Start Application//
browser -> dashboard: get /pd/application/teacher
    rnote right dashboard: teacher_application#new
    'dashboard/app/controllers/pd/application/teacher_application_controller.rb
activate dashboard
browser <-- dashboard: /app/views/pd/application/teacher_application/logged_out.haml
    'return options: logged_out || not_teacher || submitted || dashboard/app/views/pd/application/teacher_application/new.html.haml
teacher <-- browser: Sign in/Sign up page
alt Teacher doesn't have CDO account
    teacher -> browser: Select //Create an account// (and sign in)
else Teacher already has CDO account
    teacher -> browser: Select //Sign in//
end
teacher <-- browser: Teacher application form
teacher -> browser: Fill out and submit form
teacher <-- browser: Submission confirmation page
teacher <-- dashboard: Submission confirmation email
dashboard ->> principal: Request to approve this application
deactivate browser
deactivate teacher
deactivate dashboard
...

alt Principal approves application
dashboard <-- principal: Approve
activate dashboard
teacher <-- dashboard: Approval email
else Principal rejects application
dashboard <-- principal: Reject
teacher <-- dashboard: Rejection email
end

deactivate dashboard

== Register/Enroll in a workshop ==

...
dashboard <- partner: Request to review applications
activate dashboard
dashboard --> partner: Application cohort view
deactivate dashboard
alt Partner rejects application
    teacher <-- partner: Rejection email
else Partner accepts application
    teacher <-- partner: Acceptance email
    teacher <-- partner: Workshop registration email
    teacher -> browser: Go to workshop registration link
    activate browser
    teacher <-- browser: Registration form
    teacher -> browser: Submit form
    teacher <-- browser: Confirmation page
    deactivate browser

    teacher <-- dashboard: Reminder emails
    teacher <-- dashboard: Pre-workshop survey
end

@enduml